)
# reduce
am.reduced = am %>%
group_by(pnum, stim_sex, median_split) %>%
summarise(mean_morality_rating=mean(mean_morality_rating),.groups = 'keep') %>%
ungroup()
am = full_join(
m,
a,
) %>% relocate(-c(mean_morality_rating))
am <- am %>%
relocate(pnum, page, psex, mval, stim_num, stim_id_full, stim_id, stim_factor,
stim_attr, stim_sex,
attrval, mean_morality_rating)
# calculate median attractiveness rating
am <- am %>%
group_by(pnum) %>%
mutate(median_attr = median(attrval))
# say for each stim whether it is hi or lo
am <- am %>%
mutate(
median_split=
case_when(
attrval <= median_attr ~ "LOW",
#attrval == median_attr ~ "mid",
attrval > median_attr ~  "HIGH",
.default = as.character(NA)
)
) %>% ungroup()
# factorise
am=am %>%
mutate(
stim_attr =    as_factor(stim_attr),
stim_sex =     as_factor(stim_sex),
stim_num =     as_factor(stim_num),
stim_id_full = as_factor(stim_id_full),
stim_id =      as_factor(stim_id),
median_split = as_factor(median_split)
)
# reduce
am.reduced = am %>%
group_by(pnum, stim_sex, median_split) %>%
summarise(mean_morality_rating=mean(mean_morality_rating),.groups = 'keep') %>%
ungroup()
print(with(am.reduced, table(pnum, stim_sex, median_split)))
am <- am %>% filter(pnum != 12)
#reduce again after removing
am.reduced = am %>%
group_by(pnum, stim_sex, median_split) %>%
summarise(mean_morality_rating=mean(mean_morality_rating),.groups = 'keep') %>%
ungroup()
message("\nmodel3, unreduced\n")
am$pnum = as_factor(am$pnum)
model3=
ezANOVA(am,
dv=mean_morality_rating,
wid=pnum,
within=c(stim_sex, median_split),
return_aov = F
)
print(model3)
source("~/gits/lilly-qualtrics-data/step_04___.R")
print(with(am.reduced, table(pnum, stim_sex, median_split)))
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/gits/lilly-qualtrics-data/step_04___.R")
print(with(am.reduced, table(pnum, stim_sex, median_split)))
options(scipen=8)
am = full_join(
m,
a,
) %>% relocate(-c(mean_morality_rating))
am <- am %>%
relocate(pnum, page, psex, mval, stim_num, stim_id_full, stim_id, stim_factor,
stim_attr, stim_sex,
attrval, mean_morality_rating)
# calculate median attractiveness rating
am <- am %>%
##################### GROUPING ##################
group_by(pnum) %>%
##################### GROUPING ##################
mutate(median_attr = median(attrval)) %>%
ungroup()
# say for each stim whether it is hi or lo
am <- am %>%
mutate(
median_split=
case_when(
attrval <= median_attr ~ "LOW",
#attrval == median_attr ~ "mid",
attrval > median_attr ~  "HIGH",
.default = as.character(NA)
)
)
# factorise
am=am %>%
mutate(
stim_attr =    as_factor(stim_attr),
stim_sex =     as_factor(stim_sex),
stim_num =     as_factor(stim_num),
stim_id_full = as_factor(stim_id_full),
stim_id =      as_factor(stim_id),
median_split = as_factor(median_split)
)
# reduce
am.reduced = am %>%
group_by(pnum, stim_sex, median_split) %>%
summarise(mean_morality_rating=mean(mean_morality_rating),.groups = 'keep') %>%
ungroup()
print(with(am.reduced, table(pnum, stim_sex, median_split)))
source("~/gits/lilly-qualtrics-data/step_04___.R")
am.reduced.means <- am.reduced %>%
group_by(stim_sex, median_split) %>%
summarise(mean_morality_rating=mean(mean_morality_rating))
am.reduced.means
ggplot(data=am, aes(y=mean_morality_rating, x=stim_sex, group=median_split))+
stat_summary()
ggplot(data=am, aes(y=mean_morality_rating, x=stim_sex,
group=median_split,
color=median_split))+
stat_summary()
ggplot(data=am, aes(y=mean_morality_rating, x=stim_sex,
group=median_split,
color=median_split))+
theme_bw()+
stat_summary()
ggplot(data=am, aes(y=mean_morality_rating, x=stim_sex,
group=median_split,
color=median_split))+
theme_bw()+
theme(panel.grid = element_blank())+
stat_summary()
ggplot(data=am, aes(y=mean_morality_rating, x=stim_sex,
group=median_split,
color=median_split,
shape=median_split))+
theme_bw()+
theme(panel.grid = element_blank())+
stat_summary()
ggplot(data=am, aes(y=mean_morality_rating, x=stim_sex,
group=median_split,
color=median_split,
shape=median_split))+
theme_bw()+
theme(panel.grid = element_blank())+
stat_summary(position = position_dodge2())
ggplot(data=am, aes(y=mean_morality_rating, x=stim_sex,
group=median_split,
color=median_split,
shape=median_split))+
theme_bw()+
theme(panel.grid = element_blank())+
stat_summary(position = position_dodge())
ggplot(data=am, aes(y=mean_morality_rating, x=stim_sex,
group=median_split,
color=median_split,
shape=median_split))+
theme_bw()+
theme(panel.grid = element_blank())+
stat_summary(position = position_dodge(width=0.2))
ggplot(data=am,
aes(y=mean_morality_rating,
x=stim_sex,
group=median_split,
color=median_split,
shape=median_split),
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2))
ggplot(data=am,
aes(y=mean_morality_rating,
x=stim_sex,
group=median_split,
color=median_split,
shape=median_split),
size=4
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2))
ggplot(data=am,
aes(y=mean_morality_rating,
x=stim_sex,
group=median_split,
color=median_split,
shape=median_split),
size=40
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2))
ggplot(data=am,
aes(y=mean_morality_rating,
x=stim_sex,
group=median_split,
color=median_split,
shape=median_split),
cex=4
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2))
ggplot(data=am,
aes(y=mean_morality_rating,
x=stim_sex,
group=median_split,
color=median_split,
shape=median_split),
cex=40
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2))
ggplot(data=am,
aes(y=mean_morality_rating,
x=stim_sex,
group=median_split,
color=median_split,
shape=median_split)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=4)
ggplot(data=am,
aes(y=mean_morality_rating,
x=stim_sex,
group=median_split,
color=median_split,
shape=median_split)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=2)
ggplot(data=am,
aes(y=mean_morality_rating,
x=stim_sex,
group=median_split,
color=median_split,
shape=median_split)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1.5)
ggplot(data=am,
aes(y=mean_morality_rating,
x=stim_sex,
group=median_split,
color=median_split,
shape=median_split)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)
ggplot(data=am,
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=median_split,
shape=median_split)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)
ggplot(data=am,
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=median_split)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)
ggplot(data=am,
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=group,
shape=group)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)
ggplot(data=am,
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)
?relevel
ggplot(data=am %>% relevel(stim_sex, ref="LOW"),
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)
ggplot(data=am %>% mutate(stim_sex=factor(stim_sex, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)
am %>% mutate(stim_sex=factor(stim_sex, levels=c("LOW", "HIGH"))
)
ggplot(data=am %>% mutate(stim_sex=factor(stim_sex, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)
ggplot(data=am %>% mutate(median_splitx=factor(median_split, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)
ggplot(data=am %>% mutate(median_split=factor(median_split, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)
ggplot(data=am %>% mutate(median_split=factor(median_split, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)+
geom_line()
ggplot(data=am %>% mutate(median_split=factor(median_split, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)+
geom_line(aes(group=1))
ggplot(data=am %>% mutate(median_split=factor(median_split, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)+
geom_line(aes(group=stim_sex))
ggplot(data=am %>% mutate(median_split=factor(median_split, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)+
stat_summary(fun.y=mean, colour="red", geom="line")
ggplot(data=am %>% mutate(median_split=factor(median_split, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)+
stat_summary(fun.y=mean, colour="red", geom="line", position = position_dodge(width=0.2))
ggplot(data=am %>% mutate(median_split=factor(median_split, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=median_split,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)+
stat_summary(fun.y=mean, aes(colour=stim_sex), geom="line", position = position_dodge(width=0.2))
names(am)
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/gits/lilly-qualtrics-data/step_04___.R")
plot1=ggplot(data=am %>% mutate(attractiveness_level=factor(attractiveness_level, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=attractiveness_level,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)+
stat_summary(fun.y=mean, aes(colour=stim_sex), geom="line", position = position_dodge(width=0.2))+
ylab("foo")
print(plot1)
plot1=ggplot(data=am %>% mutate(attractiveness_level=factor(attractiveness_level, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=attractiveness_level,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)+
stat_summary(fun.y=mean, aes(colour=stim_sex), geom="line", position = position_dodge(width=0.2))+
ylab("Degree of moral disapproval")
print(plot1)
plot1=ggplot(data=am %>% mutate(attractiveness_level=factor(attractiveness_level, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=attractiveness_level,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)+
stat_summary(fun.y=mean, aes(colour=stim_sex), geom="line", position = position_dodge(width=0.2))+
ylab("Degree of blame in scenarios")
print(plot1)
plot1=ggplot(data=am %>% mutate(attractiveness_level=factor(attractiveness_level, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=attractiveness_level,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1, legend="foo")+
stat_summary(fun.y=mean, aes(colour=stim_sex), geom="line", position = position_dodge(width=0.2))+
ylab("Degree of blame in scenarios")
print(plot1)
?stat_summary
plot1=ggplot(data=am %>% mutate(attractiveness_level=factor(attractiveness_level, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=attractiveness_level,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)+
stat_summary(fun.y=mean, aes(colour=stim_sex), geom="line", position = position_dodge(width=0.2))+
ylab("Degree of blame in scenarios")+
labs(color="foo")
print(plot1)
plot1=ggplot(data=am %>% mutate(attractiveness_level=factor(attractiveness_level, levels=c("LOW", "HIGH"))),
aes(y=mean_morality_rating,
group=stim_sex,
x=attractiveness_level,
color=stim_sex,
shape=stim_sex)
) +
theme_bw() +
theme(panel.grid = element_blank()) +
stat_summary(position = position_dodge(width=0.2), size=1)+
stat_summary(fun.y=mean, aes(colour=stim_sex), geom="line", position = position_dodge(width=0.2))+
ylab("Degree of blame in scenarios")+
labs(color="gender",shape="gender")
print(plot1)
source("~/gits/lilly-qualtrics-data/step_04___.R")
source("~/.active-rstudio-document", echo=TRUE)
am.reduced.means <- am.reduced %>%
group_by(stim_sex, attractiveness_level) %>%
summarise(mean_morality_rating=mean(mean_morality_rating))
am.reduced.means
